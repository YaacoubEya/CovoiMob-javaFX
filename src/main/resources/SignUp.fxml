<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.effect.Glow?>
<?import javafx.scene.paint.Color?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.shape.Circle?>

<AnchorPane xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="controllers.SignupController"
            prefHeight="600.0" prefWidth="800.0"
            style="-fx-font-family: 'Segoe UI', Arial, sans-serif;
                   -fx-background-color: linear-gradient(to bottom right, #f0f8ff, #e6f2ff);
                   -fx-padding: 0;">

    <!-- ============== -->
    <!-- En-tête animé -->
    <!-- ============== -->
    <HBox alignment="CENTER_LEFT" spacing="20"
          style="-fx-background-color: linear-gradient(to right, #c9eaff, #eaf6ff);
                 -fx-padding: 15;
                 -fx-border-width: 0 0 2 0;
                 -fx-border-color: #b3d1f5;
                 -fx-background-radius: 0 0 12 12;
                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 4);"
          AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

        <Label text="🚗 COVOITMOB"
               style="-fx-font-size: 28px;
                      -fx-font-weight: bold;
                      -fx-text-fill: #002244;
                      -fx-font-family: 'Segoe UI', sans-serif;
                      -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.8), 0, 0, 0, 1);" />

        <!-- Animation de points en mouvement -->
        <HBox spacing="5" alignment="CENTER" style="-fx-padding: 0 0 0 20;">
            <Circle radius="5" fill="#005288"
                    style="-fx-effect: dropshadow(gaussian, rgba(0,82,136,0.5), 2, 0.5, 0, 1);
                           -fx-opacity: 0.6;
                           -fx-scale-x: 1;
                           -fx-scale-y: 1;
                           -fx-translate-y: 0;
                           -fx-transition: all 0.5s ease;">
                <effect>
                    <Glow level="0.3"/>
                </effect>
            </Circle>
            <Circle radius="5" fill="#005288"
                    style="-fx-effect: dropshadow(gaussian, rgba(0,82,136,0.5), 2, 0.5, 0, 1);
                           -fx-opacity: 0.8;
                           -fx-scale-x: 1;
                           -fx-scale-y: 1;
                           -fx-translate-y: 0;
                           -fx-transition: all 0.5s ease 0.2s;">
                <effect>
                    <Glow level="0.3"/>
                </effect>
            </Circle>
            <Circle radius="5" fill="#005288"
                    style="-fx-effect: dropshadow(gaussian, rgba(0,82,136,0.5), 2, 0.5, 0, 1);
                           -fx-opacity: 1;
                           -fx-scale-x: 1;
                           -fx-scale-y: 1;
                           -fx-translate-y: 0;
                           -fx-transition: all 0.5s ease 0.4s;">
                <effect>
                    <Glow level="0.3"/>
                </effect>
            </Circle>
        </HBox>
    </HBox>

    <!-- ====================== -->
    <!-- Contenu principal -->
    <!-- ====================== -->
    <HBox alignment="CENTER" spacing="40"
          style="-fx-background-color: transparent;
                 -fx-padding: 20px;"
          AnchorPane.topAnchor="80" AnchorPane.bottomAnchor="20" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20">

        <!-- ============== -->
        <!-- Section Image -->
        <!-- ============== -->
        <VBox alignment="CENTER" spacing="20"
              style="-fx-background-color: #e6f2ff;
                     -fx-background-radius: 15;
                     -fx-border-radius: 15;
                     -fx-border-color: #b3d7ff;
                     -fx-border-width: 1;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 20, 0.3, 0, 5);
                     -fx-padding: 20px;
                     -fx-transition: all 0.3s ease;">

            <ImageView fitHeight="500" fitWidth="400" preserveRatio="true"
                       style="-fx-effect: dropshadow(gaussian, rgba(0,40,100,0.3), 15, 0.3, 0, 5);
                             -fx-transition: all 0.5s ease;">
                <image>
                    <Image url="@/img/pic7.jpg" />
                </image>
            </ImageView>

            <Label text="Rejoignez notre communauté de covoiturage"
                   style="-fx-font-size: 18px;
                          -fx-text-fill: #002244;
                          -fx-font-weight: bold;
                          -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.8), 0, 0, 0, 1);" />

            <!-- Badge de confiance -->
            <HBox alignment="CENTER" spacing="10"
                  style="-fx-background-color: rgba(0,82,136,0.1);
                         -fx-background-radius: 20;
                         -fx-padding: 10 20;
                         -fx-border-color: #b3d7ff;
                         -fx-border-width: 1;
                         -fx-border-radius: 20;">
                <ImageView fitHeight="30" fitWidth="30">
                    <image>
                        <Image url="@/img/pic13.png" />
                    </image>
                    <effect>
                        <Glow level="0.5"/>
                    </effect>
                </ImageView>
                <Label text="Plateforme sécurisée"
                       style="-fx-text-fill: #005288;
                              -fx-font-weight: bold;
                              -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
            </HBox>
        </VBox>

        <!-- ================= -->
        <!-- Section Formulaire -->
        <!-- ================= -->
        <VBox spacing="20" alignment="CENTER" prefWidth="500"
              style="-fx-background-color: linear-gradient(to bottom, #c2e4fb, #eff6ff);
                     -fx-background-radius: 25;
                     -fx-border-radius: 25;
                     -fx-border-color: linear-gradient(to right, #001f4d, #003366);
                     -fx-border-width: 1;
                     -fx-padding: 30;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 15, 0.3, 0, 5);
                     -fx-font-family: 'Segoe UI', sans-serif;">

            <!-- Titre animé -->
            <Label text="👤 Créer un compte"
                   style="-fx-font-size: 24px;
                          -fx-font-weight: bold;
                          -fx-text-fill: linear-gradient(to right, #001133, #003366);
                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 3, 0.3, 0, 2);
                          -fx-background-color: transparent;
                          -fx-padding: 0 0 10 0;
                          -fx-border-width: 0 0 3 0;
                          -fx-border-color: linear-gradient(to right, #001f4d, #003366);
                          -fx-transition: all 0.3s ease;" />

            <!-- Grille de formulaire -->
            <GridPane hgap="20" vgap="15" alignment="CENTER"
                      style="-fx-background-color: transparent;">
                <columnConstraints>
                    <ColumnConstraints percentWidth="50" />
                    <ColumnConstraints percentWidth="50" />
                </columnConstraints>

                <!-- ============== -->
                <!-- Ligne 1 -->
                <!-- ============== -->
                <VBox spacing="6" GridPane.columnIndex="0">
                    <Label text="👤 Prénom *"
                           style="-fx-font-weight: bold;
                                  -fx-text-fill: #002244;
                                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <TextField fx:id="firstNameField" promptText="Votre prénom"
                               style="-fx-background-radius: 12;
                                      -fx-border-radius: 12;
                                      -fx-border-color: #003366;
                                      -fx-border-width: 1.5;
                                      -fx-padding: 8 12;
                                      -fx-background-color: white;
                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                      -fx-transition: all 0.2s ease;" />
                    <Label fx:id="firstNameError"
                           style="-fx-text-fill: #e74c3c;
                                  -fx-font-size: 12px;
                                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>

                <VBox spacing="6" GridPane.columnIndex="1">
                    <Label text="👥 Nom *"
                           style="-fx-font-weight: bold;
                                  -fx-text-fill: #002244;
                                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <TextField fx:id="lastNameField" promptText="Votre nom"
                               style="-fx-background-radius: 12;
                                      -fx-border-radius: 12;
                                      -fx-border-color: #003366;
                                      -fx-border-width: 1.5;
                                      -fx-padding: 8 12;
                                      -fx-background-color: white;
                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                      -fx-transition: all 0.2s ease;" />
                    <Label fx:id="lastNameError"
                           style="-fx-text-fill: #e74c3c;
                                  -fx-font-size: 12px;
                                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>

                <!-- ============== -->
                <!-- Ligne 2 -->
                <!-- ============== -->
                <!-- ============== -->
                <!-- Ligne 2 -->
                <!-- ============== -->
                <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="1">
                    <Label text="📧 Email *"
                           style="-fx-font-weight: bold;
                  -fx-text-fill: #002244;
                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <TextField fx:id="emailField" promptText="exemple@email.com"
                               style="-fx-background-radius: 12;
                      -fx-border-radius: 12;
                      -fx-border-color: #003366;
                      -fx-border-width: 1.5;
                      -fx-padding: 8 12;
                      -fx-background-color: white;
                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                      -fx-transition: all 0.2s ease;" />
                    <Label fx:id="emailError"
                           style="-fx-text-fill: #e74c3c;
                  -fx-font-size: 12px;
                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>
                <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="1">
                    <Label text="📱 Téléphone *"
                           style="-fx-font-weight: bold;
                                  -fx-text-fill: #002244;
                                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <TextField fx:id="telephoneField" promptText="XX XXX XXX"
                               style="-fx-background-radius: 12;
                                      -fx-border-radius: 12;
                                      -fx-border-color: #003366;
                                      -fx-border-width: 1.5;
                                      -fx-padding: 8 12;
                                      -fx-background-color: white;
                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                      -fx-transition: all 0.2s ease;" />
                    <Label fx:id="telephoneError"
                           style="-fx-text-fill: #e74c3c;
                                  -fx-font-size: 12px;
                                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>

                <!-- ============== -->
                <!-- Ligne 3 - Mot de passe -->
                <!-- ============== -->
                <VBox spacing="6" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="2">
                    <Label text="🔑 Mot de passe *"
                           style="-fx-font-weight: bold;
                                  -fx-text-fill: #002244;
                                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <HBox spacing="10">
                        <PasswordField fx:id="passwordField" promptText="Mot de passe"
                                       style="-fx-background-radius: 12;
                                              -fx-border-radius: 12;
                                              -fx-border-color: #003366;
                                              -fx-border-width: 1.5;
                                              -fx-padding: 8 12;
                                              -fx-background-color: white;
                                              -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                              -fx-transition: all 0.2s ease;" />
                        <TextField fx:id="passwordVisibleField" promptText="Mot de passe"
                                   visible="false" managed="false"
                                   style="-fx-background-radius: 12;
                                          -fx-border-radius: 12;
                                          -fx-border-color: #003366;
                                          -fx-border-width: 1.5;
                                          -fx-padding: 8 12;
                                          -fx-background-color: white;
                                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                          -fx-transition: all 0.2s ease;" />
                        <Button text="👁" onAction="#togglePasswordVisibility"
                                style="-fx-background-color: transparent;
                                       -fx-font-size: 16px;
                                       -fx-padding: 8 12;
                                       -fx-cursor: hand;
                                       -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 1, 0.5, 0, 1);" />
                    </HBox>
                    <Label fx:id="passwordError"
                           style="-fx-text-fill: #e74c3c;
                                  -fx-font-size: 12px;
                                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>

                <!-- ============== -->
                <!-- Ligne 4 - Confirmation -->
                <!-- ============== -->
                <VBox spacing="6" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="3">
                    <Label text="🔏 Confirmer mot de passe *"
                           style="-fx-font-weight: bold;
                                  -fx-text-fill: #002244;
                                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <HBox spacing="10">
                        <PasswordField fx:id="confirmPasswordField" promptText="Confirmer le mot de passe"
                                       style="-fx-background-radius: 12;
                                              -fx-border-radius: 12;
                                              -fx-border-color: #003366;
                                              -fx-border-width: 1.5;
                                              -fx-padding: 8 12;
                                              -fx-background-color: white;
                                              -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                              -fx-transition: all 0.2s ease;" />
                        <TextField fx:id="confirmPasswordVisibleField" promptText="Confirmer le mot de passe"
                                   visible="false" managed="false"
                                   style="-fx-background-radius: 12;
                                          -fx-border-radius: 12;
                                          -fx-border-color: #003366;
                                          -fx-border-width: 1.5;
                                          -fx-padding: 8 12;
                                          -fx-background-color: white;
                                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                          -fx-transition: all 0.2s ease;" />
                        <Button text="👁" onAction="#toggleConfirmPasswordVisibility"
                                style="-fx-background-color: transparent;
                                       -fx-font-size: 16px;
                                       -fx-padding: 8 12;
                                       -fx-cursor: hand;
                                       -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 1, 0.5, 0, 1);" />
                    </HBox>
                    <Label fx:id="confirmPasswordError"
                           style="-fx-text-fill: #e74c3c;
                                  -fx-font-size: 12px;
                                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>

                <!-- ============== -->
                <!-- Ligne 5 - Véhicule -->
                <!-- ============== -->
                <VBox spacing="6" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="4">
                    <Label text="🚗 Modèle Véhicule"
                           style="-fx-font-weight: bold;
                                  -fx-text-fill: #002244;
                                  -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.5), 0, 0, 0, 1);" />
                    <TextField fx:id="vehiculeField" promptText="Modèle de votre véhicule"
                               style="-fx-background-radius: 12;
                                      -fx-border-radius: 12;
                                      -fx-border-color: #003366;
                                      -fx-border-width: 1.5;
                                      -fx-padding: 8 12;
                                      -fx-background-color: white;
                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 2, 0.2, 0, 1);
                                      -fx-transition: all 0.2s ease;" />
                    <Label fx:id="vehiculeError"
                           style="-fx-text-fill: #e74c3c;
                                  -fx-font-size: 12px;
                                  -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.2), 1, 0.5, 0, 1);" />
                </VBox>

                <rowConstraints>
                    <RowConstraints />
                    <RowConstraints />
                    <RowConstraints />
                    <RowConstraints />
                    <RowConstraints />
                </rowConstraints>

                <!-- ============== -->
                <!-- Bouton Valider -->
                <!-- ============== -->
                <Button text="S'inscrire" onAction="#handleSignup"
                        style="-fx-background-radius: 25;
                               -fx-text-fill: white;
                               -fx-font-size: 16px;
                               -fx-font-weight: bold;
                               -fx-padding: 10 25;
                               -fx-background-color: linear-gradient(to right, #001f4d, #003366);
                               -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 8, 0.3, 0, 4);
                               -fx-transition: all 0.3s ease;"
                        GridPane.columnSpan="2" GridPane.rowIndex="5" />

                <!-- ============== -->
                <!-- Lien Connexion -->
                <!-- ============== -->
                <Hyperlink text="Déjà un compte ? Se connecter" onAction="#switchToSignIn" fx:id="signInBtn"
                           style="-fx-text-fill: #003366;
                                  -fx-font-size: 14px;
                                  -fx-underline: true;
                                  -fx-border-color: transparent;
                                  -fx-cursor: hand;
                                  -fx-font-weight: bold;
                                  -fx-transition: all 0.2s ease;"
                           GridPane.columnSpan="2" GridPane.rowIndex="6" />
            </GridPane>
        </VBox>
    </HBox>

    <!-- ============== -->

</AnchorPane>